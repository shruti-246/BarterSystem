{% extends "base.html" %}
{% block title %}All Products - BarterDB{% endblock %}
{% block content %}

<h1>All Available Products</h1>

<div class="product-list" id="product-list"></div>

<div class="back-link" onclick="goBack()">‚Üê Back to Dashboard</div>

<script>
const BACKEND_URL = "{{ request.host_url.rstrip('/') }}";

async function loadProducts() {
  try {
    const res = await fetch(`${BACKEND_URL}/items`);
    const products = await res.json();
    const container = document.getElementById('product-list');
    container.innerHTML = '';

    if (!products.length) {
      container.innerHTML = '<p>No products available.</p>';
    } else {
      products.forEach(prod => {
        const div = document.createElement('div');
        div.className = 'product-card';
        div.innerHTML = `
          <strong>${prod.name}</strong><br>
          ${prod.description}<br>
          <em>Category:</em> ${prod.category}<br>
          <em>Condition:</em> ${prod.condition}<br>
          <em>Value:</em> $${prod.estimated_value}<br>
          <em>Owner:</em> ${prod.owner_username}
        `;
        container.appendChild(div);
      });
    }
  } catch (error) {
    alert('Failed to fetch products.');
  }
}

function goBack() {
  window.location.href = "{{ url_for('dashboard_view') }}";
}

loadProducts();
</script>

{% endblock %}


