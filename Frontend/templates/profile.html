{% extends "base.html" %}
{% block title %}My Profile - BarterDB{% endblock %}
{% block content %}

<h1>My Profile</h1>

<div class="profile-info" id="profile"></div>

<div class="edit" onclick="goToEdit()">✏️ Edit Profile</div>

<div class="back-btn">
  <button onclick="goBack()">← Back to Dashboard</button>
</div>

<script>
const BACKEND_URL = "{{ request.host_url.rstrip('/') }}";
const userId = sessionStorage.getItem('user_id');

if (!userId) {
  alert('Please login first!');
  window.location.href = "{{ url_for('signup_login_view') }}";
}

async function loadProfile() {
  try {
    const res = await fetch(`${BACKEND_URL}/profile/${userId}`);
    const profile = await res.json();
    const container = document.getElementById('profile');
    container.innerHTML = `
      <strong>Username:</strong> ${profile.username}<br>
      <strong>Email:</strong> ${profile.email}<br>
      <strong>Role:</strong> ${profile.role}
    `;
  } catch (error) {
    alert('Failed to load profile.');
  }
}

function goBack() {
  window.location.href = "{{ url_for('dashboard_view') }}";  
}

function goToEdit() {
  window.location.href = "{{ url_for('edit_profile_view') }}";
}

loadProfile();
</script>

{% endblock %}



